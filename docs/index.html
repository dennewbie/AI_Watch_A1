<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AI Watch A1: AI Watch A1 documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="eye_small_white.png"/></td>
  <td id="projectalign">
   <div id="projectname">AI Watch A1
   </div>
   <div id="projectbrief">Multi-person 3D skeleton detection using Intel RealSense and OpenPose with Kafka support.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">AI Watch A1 documentation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p >This is the AI Watch A1 docum entation for C++. AI Watch A1 uses one Intel RealSense D435 camera and OpenPose in order to achieve multi-person 3D skeleton detection. Once this task is completed, AI Watch A1 provides support to send each detected skeleton and its joint points' 3D coordinates (room and D435's details have to be specified) via Kafka, in order to let further detached computation possible.</p>
<h1><a class="anchor" id="keynote_sec"></a>
Keynote 📋</h1>
<ul>
<li><a href="https://github.com/dennewbie/AI_Watch_A1/blob/main/caruso_denny_tesi_bsc_cs.key">Keynote</a></li>
</ul>
<h1><a class="anchor" id="demo_sec"></a>
Demo 💻</h1>
<ul>
<li><a href="https://youtu.be/Ac0V8Dj0FbI">Demo #1</a></li>
<li><a href="https://youtu.be/pq3m9U3hRrQ">Demo #2</a></li>
</ul>
<h1><a class="anchor" id="otherdoc_sec"></a>
Other Docs 📜</h1>
<ul>
<li>Bachelor Thesis in Computer Science: <a href="http://www.tesionline.it/default/tesi.asp?idt=57417">PDF TesiOnline</a></li>
</ul>
<h1><a class="anchor" id="install_sec"></a>
Installation 🚀</h1>
<p >Note: Instructions for MacOS with Intel CPU / M1 chip</p>
<p >1) Install <a href="https://github.com/IntelRealSense/librealsense">RealSense SDK 2.0</a> and its own dependencies. The following guide is really helpful: <a href="https://lightbuzz.com/realsense-macos/">build RealSense for macOS Monterey (Intel + Apple Silicon)</a>.</p>
<p >2) Install <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose">OpenPose</a> and its own dependencies. Useful guides: <a href="https://medium.com/@alok.gandhi2002/build-openpose-with-without-gpu-support-for-macos-catalina-10-15-6-8fb936c9ab05#726f">build openpose with/without GPU support for macOS</a>, <a href="https://blog.csdn.net/qq_27180763/article/details/126134888?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_utm_term~default-0-126134888-blog-122796729.pc_relevant_layerdownloadsortv1&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">OpenPose for M1/Intel</a>.</p>
<p >In order to properly choose the <code>GPU_MODE</code> during OpenPose installation and/or in order to install OpenPose on other operating systems, check out this page: <a href="https://cmu-perceptual-computing-lab.github.io/openpose/web/html/doc/md_doc_installation_0_index.html">OpenPose Docs</a>. If you have MacOS with Intel CPU and a GPU that matches OpenPose prerequisites, then you can set <code>GPU_MODE</code> to <code>OPENCL</code> (GPU-accelerated, it is harder to install but provides a faster runtime speed). Otherwise, if you have a MacOS with M1 chip, it's suggested to set <code>GPU_MODE</code> to <code>CPU_ONLY</code>.</p>
<p ><a href="https://user-images.githubusercontent.com/41870472/197208265-82949343-d927-4894-ac0b-591c788e7974.png">CMake Settings for Intel</a></p>
<p ><a href="https://user-images.githubusercontent.com/41870472/197208278-4498ff62-0295-4eda-b6a1-023c2d89c0ec.png">CMake Settings for &gt;= M1</a></p>
<p >3) Install <a href="https://kafka.apache.org/">Apache Kafka</a>, <a href="https://www.confluent.io/">Confluent</a> and their own dependencies. Confluent is not mandatory, but without it, you will have to set up the Kafka environment on your own. Useful guides:</p>
<p ><a href="https://www.conduktor.io/kafka/how-to-install-apache-kafka-on-mac">how to install Apache Kafka on Mac</a>, <a href="https://docs.confluent.io/4.0.1/installation/installing_cp.html">how to install Confluent</a>.</p>
<p >4) Run the following command in your terminal: </p><div class="fragment"><div class="line">git clone --recursive git@github.com:dennewbie/AI_Watch_A1.git</div>
</div><!-- fragment --><p> After that, remove all the files named <code>emptyFileForPadding.txt</code> in the cloned folder.</p>
<p >5) From <code>/AI_Watch_A1/src/AI_Watch_A1/</code> folder, run the following commands in your terminal:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
</div><!-- fragment --><p >6) Copy OpenPose's <code>models</code> folder to the project's build folder.</p>
<p >7) Copy OpenPose's <code>BoostConfig.cmake</code>, <code>FindGFlags.cmake</code> and <code>FindGlog.cmake</code> files to the <code>build/cmake/modules/</code> folder.</p>
<p >8) Update <code>caffe lib</code> path inside <code>CMakeLists.txt</code>. Then run the following commands in your terminal:</p>
<div class="fragment"><div class="line">cmake .. &amp;&amp; make -j `sysctl -n hw.logicalcpu`</div>
</div><!-- fragment --><p >9) This step is optional. Run the following command in your terminal:</p>
<div class="fragment"><div class="line">sudo make install</div>
</div><!-- fragment --><p >10) Now let's start the Kafka environment. Run the following commands in a new terminal session located on the parent folder of the <code>confluent</code> folder. Set the environment variable for the Confluent Platform home directory: </p><div class="fragment"><div class="line">export CONFLUENT_HOME=confluent-7.2.1</div>
</div><!-- fragment --><p> Add the Confluent Platform bin directory to your PATH:</p>
<div class="fragment"><div class="line">export PATH=$PATH:$CONFLUENT_HOME/bin</div>
</div><!-- fragment --><p> Test your installation by running the confluent command: </p><div class="fragment"><div class="line">confluent --help</div>
</div><!-- fragment --><p> Your output should show the available commands for managing Confluent Platform.</p>
<p >Start Confluent Platform by using the Confluent CLI confluent local services start command. This command starts all of the Confluent Platform components, including Kafka, ZooKeeper, Schema Registry, HTTP REST Proxy for Kafka, Kafka Connect, ksqlDB, and Control Center. </p><div class="fragment"><div class="line">confluent local services start</div>
</div><!-- fragment --><p >Your output should resemble: </p><div class="fragment"><div class="line">Starting Zookeeper</div>
<div class="line">Zookeeper is [UP]</div>
<div class="line">Starting Kafka</div>
<div class="line">Kafka is [UP]</div>
<div class="line">Starting Schema Registry</div>
<div class="line">Schema Registry is [UP]</div>
<div class="line">Starting Kafka REST</div>
<div class="line">Kafka REST is [UP]</div>
<div class="line">Starting Connect</div>
<div class="line">Connect is [UP]</div>
<div class="line">Starting KSQL Server</div>
<div class="line">KSQL Server is [UP]</div>
<div class="line">Starting Control Center</div>
<div class="line">Control Center is [UP]</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md0"></a>
Important #1 📌</h3>
<p >The confluent local commands are intended for a single-node development environment and are not suitable for a production environment. The data that are produced are transient and are intended to be temporary. For production-ready workflows, check <a href="https://www.confluent.io/">Confluent website</a>.</p>
<h3><a class="anchor" id="autotoc_md1"></a>
Important #2 📌</h3>
<p >The Confluent CLI requires Java version 1.8 or 1.11. See <a href="https://docs.confluent.io/current/installation/versions-interoperability.html">Confluent versions interoperability</a>.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Important #3 📌</h3>
<p >In order to improve speed and general performance, you could disable images' showing and change the number of frames captured per second. In this last option, capturing too few frames per second reduces output' quality. Furthermore, it's also possible to reduce OpenPose's network resolution, but a significant drawback is reduced accuracy.</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Important #4 📌</h3>
<p >Place the camera in a way that it can "see" the left and the right wall of the room.</p>
<p >11) Navigate to <code><a href="http://localhost:9021">http://localhost:9021</a></code> and create a new topic <code>topic1</code> with default settings. Now go to <code>/AI_Watch_A1/src/AI_Watch_A1/</code> and set up your <a href="https://github.com/edenhill/librdkafka">Kafka</a> parameters within the <code>configuration_file.ini</code> file. At this point:</p><ul>
<li>if internal OpenPose execution is chosen, then run the following command in your terminal:</li>
</ul>
<div class="fragment"><div class="line">sudo ./AI_Watch_A1.bin --num_gpu 1 --num_gpu_start 2 --image_dir rs_images/rgb --write_json op_output/op --logging_level 255</div>
</div><!-- fragment --><ul>
<li>if external OpenPose execution is chosen, then set up your OpenPose parameters within the <code>conf.conf</code> file and run the following command in your terminal:</li>
</ul>
<div class="fragment"><div class="line">sudo ./AI_Watch_A1.bin</div>
</div><!-- fragment --><p >Note that the internal OpenPose execution is suggested.</p>
<h1><a class="anchor" id="issues_sec"></a>
Known issues ⚠️</h1>
<p >1) The module can rarely get stuck on the following invocation located in <code><a class="el" href="classRealSenseD435Manager.html" title="RealSenseD435Manager class is a class that abstracts the behavior of an Intel RealSense D435 Camera,...">RealSenseD435Manager</a>::23</code>:</p>
<div class="fragment"><div class="line">rs2::pipeline_profile myPipelineProfile = pipelineStream.start(myConfiguration);</div>
</div><!-- fragment --><p >This means some errors have occurred, due to the USB connection while starting the camera's environment. In order to fix that, just exit the program, unplug the RealSense camera from the USB cable, and connect it again.</p>
<h1><a class="anchor" id="sys_structure"></a>
System Structure 🏛</h1>
<p ><a href="https://github.com/dennewbie/AI_Watch_A1/blob/main/design/A1_details.png">A1 System Structure</a></p>
<h1><a class="anchor" id="tools_sec"></a>
Tools 🛠</h1>
<ul>
<li><a href="https://github.com/IntelRealSense/librealsense">Intel RealSense SDK</a></li>
<li><a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose">OpenPose</a></li>
<li><a href="https://github.com/opencv/opencv">OpenCV</a></li>
<li><a href="https://www.khronos.org/opencl/">OpenCL</a></li>
<li><a href="https://kafka.apache.org/">Kafka</a></li>
<li><a href="https://github.com/edenhill/librdkafka">Kafka C/C++ library</a></li>
<li><a href="https://www.confluent.io/">Confluent</a></li>
<li><a href="https://github.com/open-source-parsers/jsoncpp">jsoncpp</a></li>
<li><a href="https://doxygen.nl/">Doxygen</a></li>
<li><a href="https://staruml.io/">StarUML</a></li>
<li><a href="https://www.sketch.com/">Sketch</a></li>
</ul>
<h1><a class="anchor" id="contributing_sec"></a>
Contributing 👨🏻👳🏾‍♂️👩🏼‍🦱👽</h1>
<p >In order to contribute to AI Watch A1, please follow the <a href="https://github.com/dennewbie/AI_Watch_A1/blob/main/CONTRIBUTING.md">contribution guidelines</a>.</p>
<h1><a class="anchor" id="license_sec"></a>
License ☢️</h1>
<p >AI Watch A1 is licensed under the Apache License, Version 2.0. Copyright 2022. Please, see the <a href="https://github.com/dennewbie/AI_Watch_A1/blob/main/LICENSE">license</a> for further details and the <code>/licenses</code> folder for the used libraries' licenses details.</p>
<h1><a class="anchor" id="contacts_sec"></a>
Contacts 🪪</h1>
<ul>
<li><a href="https://www.linkedin.com/in/denny-caruso/">LinkedIn</a></li>
</ul>
<h1><a class="anchor" id="citation_sec"></a>
Citation 📖</h1>
<div class="fragment"><div class="line">@report{AIWatchA1,</div>
<div class="line">    author = {Denny Caruso},</div>
<div class="line">    title = {Multi-person 3D skeleton detection with depth cameras​},</div>
<div class="line">    institution = {University of Naples, Parthenope},</div>
<div class="line">    year = {2022}</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="supervisor_sec"></a>
Supervisor</h1>
<ul>
<li><a href="https://www.researchgate.net/profile/Alessio-Ferone">Dr. Alessio Ferone</a>, CS Assistant Professor at the <a href="https://www.uniparthenope.it/">University of Naples Parthenope</a>.</li>
</ul>
<h1><a class="anchor" id="Other_modules_sec"></a>
Other modules</h1>
<ul>
<li><a href="https://github.com/Luruu/AI_Watch_B1">B1: anomaly detection + digital twin</a></li>
<li><a href="https://github.com/RenatoEsposito1999/AIWatch_C1">C1: Unity3D rendering</a></li>
</ul>
<p >a.a. 2021/2022 </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
